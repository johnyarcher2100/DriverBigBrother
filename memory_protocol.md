# 對話週期管理協議

## 上下文攜帶機制

### 自動載入文檔
每次對話自動載入以下文檔的最新版本：
- 任務主檔 (`task_master.md`)
- 進度追蹤檔 (`progress_tracking.md`)

### 文檔維護規則
- 所有文檔使用Markdown格式維護
- 時序性記錄使用表格形式，確保易於追蹤與查詢
- 重要參數使用 `[[參數名稱]]` 特殊標記符號標示

## 智能節流控制

### 緩衝區管理
當Token緩衝區使用量達85%時，自動觸發以下程序：
1. 進度壓縮程序啟動
2. 將已完成項目轉為摘要格式
3. 重構待辦列表為優先級樹狀圖
4. 生成新版文檔指紋標籤（vX.Y）

### 緩衝區觸發條件
| 緩衝區使用量 | 觸發動作 |
|------------|----------|
| 85% | 自動壓縮已完成項目，保留重要上下文 |
| 90% | 僅保留當前活動任務與關鍵阻塞問題 |
| 95% | 緊急精簡模式，僅保留目標指令與當前執行步驟 |

## 迭代重啟協議

### 狀態碼生成
- AI主動提示：「建議保存當前狀態碼[XXYYZZ]」
- 狀態碼格式：`[專案代碼][版本號][檢查碼]`
- 例如：`TJDG010A`（運將大哥v0.1檢查碼A）

### 狀態碼載入
- 用戶指令：「載入狀態碼[XXYYZZ]」
- 系統自動掛載對應版本文檔繼續作業
- 如發現文檔版本不匹配，提示用戶進行同步

## 異常處理原則

### 需求衝突處理
當檢測到需求矛盾時：
1. 自動標記衝突點位於文檔中
2. 生成多方案選擇樹供用戶選擇
3. 保留決策過程記錄於版本變更日誌

### 技術瓶頸處理
遭遇技術瓶頸時，啟動三層級解決方案：
1. 短期應急方案（快速實現但可能有限制）
2. 中期改良路徑（平衡實現難度與效能）
3. 長期架構建議（最佳實踐但需較多資源）

## 最佳實踐提醒

⚠️ 建議每3次迭代進行版本快照，確保進度可回溯
⚠️ 複雜專案需建立模組索引表，便於快速查找
⚠️ 關鍵參數應使用`[[參數名]]`特殊標記符便於追蹤
⚠️ 每日最後對話自動生成日報摘要，總結當日進度

## 狀態檢查指令

| 指令 | 功能 |
|------|------|
| `#status` | 顯示當前專案狀態摘要 |
| `#pending` | 列出所有待辦任務按優先順序 |
| `#blockers` | 顯示當前阻塞問題 |
| `#snapshot` | 手動觸發版本快照 |
| `#compress` | 手動觸發記憶壓縮 |
